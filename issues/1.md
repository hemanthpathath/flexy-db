## Background

We are building a **Database-as-a-Service (DBaaS)** to support an enterprise communication platform. The platform will handle entities such as tasks, todos, emails, messages, incidents, and other task/incident management objects.

Conceptually, the DBaaS exposes only **five core object types**:

1. Tenant  
2. User  
3. NodeType  
4. Node  
5. Relationship  

All domain entities (tasks, emails, incidents, messages, threads, channels, etc.) are modeled as **Nodes** of a particular **NodeType**, connected by **Relationships**. The DBaaS should be generic and extensible: new features should be possible by defining new NodeTypes and using Nodes/Relationships, without schema changes.

For this first implementation:

- Language: **Go**
- API: **gRPC**
- Database: **PostgreSQL**
- Scope: core data model + CRUD gRPC API for the 5 primitives
- Out of scope for now: ACL/permissions, advanced validation rules, complex indexing, search, and analytics.

The purpose of this issue is to implement the **initial version** of this DBaaS service.

---

## High-Level Requirements

1. Implement a Go service exposing a **gRPC API** that provides CRUD operations for:
   - Tenant
   - User
   - NodeType
   - Node
   - Relationship

2. Back the service with **PostgreSQL** and define the necessary tables, indices, and migrations.

3. Implement a clean internal layering:
   - Transport: gRPC server & generated code
   - Application/service layer: business logic around the 5 primitives
   - Persistence: repository interfaces + PostgreSQL implementations

4. Focus on **multi-tenancy** from day one:
   - All Nodes and Relationships must be scoped to a Tenant.
   - Users can be associated with one or more Tenants (basic membership).

5. No ACL/permissions or complex validation logic yet:
   - We can assume that the caller is authorized and that data is logically consistent.
   - Implement only basic validation (e.g., required fields, referential integrity checks).

---

## Data Model

Design the PostgreSQL schema to represent the 5 core types.

### 1. Tenant

Basic tenant record to scope all other data.

```sql
CREATE TABLE tenants (
  id          UUID PRIMARY KEY,
  slug        TEXT NOT NULL UNIQUE,     -- e.g. "acme-corp"
  name        TEXT NOT NULL,
  status      TEXT NOT NULL DEFAULT 'active',  -- active, suspended, etc.
  created_at  TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  updated_at  TIMESTAMPTZ NOT NULL DEFAULT NOW()
);```

### 2. User

Global user table plus membership in tenants.

```sql
CREATE TABLE users (
  id           UUID PRIMARY KEY,
  email        TEXT NOT NULL UNIQUE,
  display_name TEXT NOT NULL,
  created_at   TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  updated_at   TIMESTAMPTZ NOT NULL DEFAULT NOW()
);

CREATE TABLE tenant_users (
  tenant_id    UUID NOT NULL REFERENCES tenants(id) ON DELETE CASCADE,
  user_id      UUID NOT NULL REFERENCES users(id)   ON DELETE CASCADE,
  role         TEXT NOT NULL DEFAULT 'member',  -- admin, member, guest, etc.
  status       TEXT NOT NULL DEFAULT 'active',
  PRIMARY KEY (tenant_id, user_id)
);```...